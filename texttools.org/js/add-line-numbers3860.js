/*
 * Copyright (C) 2022 Text Tools. All Rights Reserved.
 * This file is part of texttools.org
 * Proprietary Software License
*/
var area=$("#input_output"),examples=JSON.parse(localStorage.getItem("ta_examples"));function Romanize(e){if(!+e)return!1;for(var t=String(+e).split(""),a=["","C","CC","CCC","CD","D","DC","DCC","DCCC","CM","","X","XX","XXX","XL","L","LX","LXX","LXXX","XC","","I","II","III","IV","V","VI","VII","VIII","IX"],r="",n=3;n--;)r=(a[+t.pop()+10*n]||"")+r;return Array(+t.join("")+1).join("M")+r}function Deromanize(e){var t,a=/[MDLV]|C[MD]?|X[CL]?|I[XV]?/g,r={M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1},n=0;if(!(e=e.toUpperCase())||!/^M*(?:D?C{0,3}|C[MD])(?:L?X{0,3}|X[CL])(?:V?I{0,3}|I[XV])$/.test(e))return!1;for(;t=a.exec(e);)n+=r[t[0]];return n}function LettertoNum(e){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZ",a=0,r=0,n=e.length-1;r<e.length;r+=1,--n)a+=Math.pow(t.length,n)*(t.indexOf(e[r])+1);return a}function NumtoLetter(e){for(var t,a="";0<e;)t=(e-1)%26,a=String.fromCharCode(65+t)+a,e=(e-t)/26|0;return a||void 0}function loadText(){var e=$("#file_upload").get(0).files[0],t=new FileReader;t.onload=function(e){e=e.target.result;area.val(e)},t.readAsText(e,"UTF-8")}function saveText(e,t){var a=navigator.userAgent.match(/MSIE\s([\d.]+)/),r=navigator.userAgent.match(/Trident\/7.0/)&&navigator.userAgent.match(/rv:11/),n=navigator.userAgent.match(/Edge/g),r=a?a[1]:r?11:n?12:-1;a&&r<10?console.log("No blobs on IE ver<10"):(t=(t=document.getElementById("input_output").value).replace(/\r?\n/g,"\r\n"),n=new Blob([t],{type:"text/plain"}),"null.txt"!=(e=prompt("File name:","New Document")+".txt")&&(-1<r?window.navigator.msSaveBlob(n,e):((a=document.createElement("a")).download=e,a.href=window.URL.createObjectURL(n),a.onclick=function(e){document.body.removeChild(e.target)},a.style.display="none",document.body.appendChild(a),a.click())))}function printTextArea(){(childWindow=window.open("","childWindow","location=yes, menubar=yes, toolbar=yes")).document.open(),childWindow.document.write('<html><head></head><body style="word-wrap:break-word;"><style>.ap_container,.google-auto-placed,.adsbygoogle{display:none}</style>'),childWindow.document.write(document.getElementById("input_output").value.replace(/\n/gi,"<br>")),childWindow.document.write("</body></html>"),childWindow.print(),childWindow.document.close(),childWindow.close()}1==examples&&area.val("The quick brown fox jumps over the lazy dog.\nThe quick brown fox jumps over the lazy dog.\nThe quick brown fox jumps over the lazy dog.\nThe quick brown fox jumps over the lazy dog."),$("#addLineNum").click(function(){Remember();var e=area.val(),t=$("#settings").val(),a=$("#numPrefix").val(),r=$("#numSuffix").val(),n=$("#numStart").val().replace(/\s/g,""),o=($(".alert").hide(),e=e.replace(/\r\n|\r|\n/gm,"\n").split("\n"),0);if(1==t)for(o=0;o<e.length;o++)1==t?e[o]=a+n+r+e[o]:2==t&&(e[o]=a+Romanize(n)+r+e[o]),n++;else if(2==t)if((n=n.toUpperCase()).match(/^M{0,4}(CM|CD|D?C{0,3})(XC|XL|L?X{0,3})(IX|IV|V?I{0,3})$/)){for(n=Deromanize(n),o=0;o<e.length;o++)$("#upperCase").prop("checked")?e[o]=a+Romanize(n).toUpperCase()+r+e[o]:e[o]=a+Romanize(n).toLowerCase()+r+e[o],n++;$(".alert").hide()}else Alert('Error: "'+n+'" is not a valid roman numeral.');else if(3==t)if(n.match(/[a-zA-Z]/)){for(n=LettertoNum(n=n.toUpperCase()),o=0;o<e.length;o++)$("#upperCase").prop("checked")?e[o]=a+NumtoLetter(n).toUpperCase()+r+e[o]:e[o]=a+NumtoLetter(n).toLowerCase()+r+e[o],n++;$(".alert").hide()}else Alert('Error: "'+n+'" is not a valid starting letter.');e=e.join("\n"),Toast("Applied"),area.val(e),Remember()}),$("#settings").on("change",function(){var e=$("#settings").val();1==e?($("#numStart").attr("type","number").attr("value","1").val(1),$("#upper-case").hide()):2==e?($("#upperCase").prop("checked")?$("#numStart").attr("type","text").attr("value","I").val("I"):$("#numStart").attr("type","text").attr("value","i").val("i"),$("#upper-case").show()):3==e&&($("#upperCase").prop("checked")?$("#numStart").attr("type","text").attr("value","A").val("A"):$("#numStart").attr("type","text").attr("value","a").val("a"),$("#upper-case").show())}),$("#upperCase").change(function(){var e=$("#settings").val();this.checked?2==e?$("#numStart").attr("type","text").attr("value","I").val("I"):3==e&&$("#numStart").attr("type","text").attr("value","A").val("A"):2==e?$("#numStart").attr("type","text").attr("value","i").val("i"):3==e&&$("#numStart").attr("type","text").attr("value","a").val("a")}),$(".clipboard").click(function(){Clipboard(area)}),$("#clearAll, #edit_delete, #file_new").click(function(){area.val(""),Remember()}),$("#file_upload").on("change",function(){loadText()}),$("#file_download").click(function(){saveText()}),$("#file_print").click(function(){printTextArea()}),$("#edit_undo").click(function(){var e=History.undo();void 0!==e&&area.val(e)}),$("#edit_redo").click(function(){var e=History.redo();void 0!==e&&area.val(e)}),$("#edit_copy").click(function(){Clipboard(area)}),$("#edit_select").click(function(){area.select().focus()});var History=function(){var t=[],a=0;return{remember:function(e){t[a-1]!==e&&(t.splice(a,10),t.push(e),t.splice(0,t.length-10),a=t.length)},undo:function(){if(1<a)return t[--a-1]},redo:function(){if(a<t.length)return t[a++]}}}();function Remember(){var e=area.val();History.remember(e)}Remember();