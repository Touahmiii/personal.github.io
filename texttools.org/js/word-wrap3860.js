/*
 * Copyright (C) 2022 Text Tools. All Rights Reserved.
 * This file is part of texttools.org
 * Proprietary Software License
*/
var area=$("#input_output"),examples=JSON.parse(localStorage.getItem("ta_examples"));function padit(e,t,i){for(i=i||" ";e.length<t;)e+=i;return e}function wordLength(e,t){var i=t;if(t<0)return 0;for(;!(e.charAt(t).match(/\s/)||++t>=e.length););return t-i}function fold(e,t,i,a){var n,u,r=0,l="";if(null==a&&(a=!0),i=i||!1,(t=t||80)<1)return e;for(var o=e.split(/\r\n|\r|\n/),s=0;s<o.length;s++)for(e=o[s]+"\n",n=0;n<e.length;n++)u=e.charAt(n),i&&0==r&&" "==u||(!a&&0<n&&(" "==e.charAt(n-1)||"\t"==e.charAt(n-1))&&wordLength(e,n)+r>t&&(l+="\n",r=0),"\t"==u?r=8*(r/8|1):"\b"==u?r=0<r?r-1:0:"\n"==u||"\r"==u?r=0:++r,l+=u,t<=r&&("\n"!=e.charAt(n+1)&&(l+="\n"),r="\t"==u?8:0));return l}function foldWithCols(e,t,i,a,n,u){e=e.replace(/\r\n|\r|\n/g,"\n");var r,l,o=padit("",u),s=fold(e,t,a,n).split("\n"),c=(""==s[s.length-1]&&s.pop(),Math.ceil(s.length/i)),d="";if(i<=1||s.length<=1)return s.join("\n");for(r=0;r<c;r++){for(l=0;l<i;l++)d+=(0<l?o:"")+padit(s[r+l*c]||"",t);d+="\n"}return d}function loadText(){var e=$("#file_upload").get(0).files[0],t=new FileReader;t.onload=function(e){e=e.target.result;area.val(e)},t.readAsText(e,"UTF-8")}function saveText(e,t){var i=navigator.userAgent.match(/MSIE\s([\d.]+)/),a=navigator.userAgent.match(/Trident\/7.0/)&&navigator.userAgent.match(/rv:11/),n=navigator.userAgent.match(/Edge/g),a=i?i[1]:a?11:n?12:-1;i&&a<10?console.log("No blobs on IE ver<10"):(t=(t=document.getElementById("input_output").value).replace(/\r?\n/g,"\r\n"),n=new Blob([t],{type:"text/plain"}),"null.txt"!=(e=prompt("File name:","New Document")+".txt")&&(-1<a?window.navigator.msSaveBlob(n,e):((i=document.createElement("a")).download=e,i.href=window.URL.createObjectURL(n),i.onclick=function(e){document.body.removeChild(e.target)},i.style.display="none",document.body.appendChild(i),i.click())))}function printTextArea(){(childWindow=window.open("","childWindow","location=yes, menubar=yes, toolbar=yes")).document.open(),childWindow.document.write('<html><head></head><body style="word-wrap:break-word;"><style>.ap_container,.google-auto-placed,.adsbygoogle{display:none}</style>'),childWindow.document.write(document.getElementById("input_output").value.replace(/\n/gi,"<br>")),childWindow.document.write("</body></html>"),childWindow.print(),childWindow.document.close(),childWindow.close()}1==examples&&area.val("    Lorem ipsum dolor sit amet, consectetur adipiscing elit. Curabitur posuere ultrices velit, eget venenatis elit aliquet vitae. Mauris pellentesque tristique odio nec maximus. Nam euismod nunc vitae porta vulputate. Vestibulum ultricies, enim sed iaculis convallis, massa enim vehicula metus, nec malesuada lacus mi ut turpis. Nulla vitae feugiat lorem, at posuere enim. Curabitur feugiat, dolor vitae imperdiet tincidunt, elit urna tempor metus, at bibendum dui erat sit amet odio. Nulla maximus lacus sem. Maecenas placerat felis cursus justo consequat, vel feugiat arcu ultricies. Morbi vulputate eget enim at faucibus. In a feugiat nisi. Phasellus a lorem sit amet libero vulputate lobortis. Morbi est metus, blandit et mollis quis, molestie sed nibh. Morbi vel turpis nec dui facilisis accumsan quis condimentum risus. Nullam tempor, nisl tincidunt tincidunt ultricies, massa nisl vulputate est, quis vulputate justo dui sed ante. Donec convallis, neque non aliquam tristique, tortor mauris mattis mi, vel venenatis urna sem eget augue. Nulla ac metus quam?\n\n    Sed varius lectus nec quam pharetra tristique. Nunc eleifend lobortis sem, quis fermentum risus pulvinar in. Pellentesque eu nisl quis mi tincidunt gravida. Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas?!?\n\n    Quisque non felis ut nisi convallis porttitor. Nam faucibus eget tellus nec dignissim. Maecenas faucibus, ipsum in venenatis malesuada, mi magna porta nibh, eget accumsan enim mauris in erat. Nam volutpat commodo justo, et luctus libero ultrices at. Morbi eu mi neque...\n\n    Proin porttitor orci a mi posuere viverra. Sed eget odio sed risus sollicitudin porttitor. Proin cursus quam vel porttitor tristique. Nulla porta, velit tincidunt posuere cursus, sapien erat mattis dui, ut tincidunt eros lacus id augue. Nunc sodales, metus eu placerat tempor, lacus ipsum blandit enim, in vulputate erat erat vitae sapien. Praesent ac felis quam. Fusce nec mi ac leo posuere laoreet. Sed porta pretium nisi at malesuada. Suspendisse potenti. Ut cursus, velit vel auctor pretium, odio lectus lacinia neque, ac laoreet nunc massa a ligula. Sed eu erat eu odio iaculis porttitor id eget tellus. Aenean bibendum felis enim, eget ullamcorper tellus mattis et. Nam gravida, nisl ac porttitor rhoncus, nulla quam sollicitudin purus, ut vulputate sem arcu eget nisl!"),$("#wrapText").click(function(){Remember();var e=area.val().replace(/\r\n|\r|\n/gm,"\n"),t=$("#wrapWidth").val(),i=$("#wrapCol").val(),a=($("#pageSize").val(),$("#colSpaces").val()),e=foldWithCols(e,t,i,$("#isTrim").prop("checked"),$("#isCut").prop("checked"),a);area.val(e),Remember()}),$(".clipboard").click(function(){Clipboard(area)}),$("#clearAll, #edit_delete, #file_new").click(function(){area.val(""),Remember()}),$("#file_upload").on("change",function(){loadText()}),$("#file_download").click(function(){saveText()}),$("#file_print").click(function(){printTextArea()}),$("#edit_undo").click(function(){var e=History.undo();void 0!==e&&area.val(e)}),$("#edit_redo").click(function(){var e=History.redo();void 0!==e&&area.val(e)}),$("#edit_copy").click(function(){Clipboard(area)}),$("#edit_select").click(function(){area.select().focus()});var History=function(){var t=[],i=0;return{remember:function(e){t[i-1]!==e&&(t.splice(i,10),t.push(e),t.splice(0,t.length-10),i=t.length)},undo:function(){if(1<i)return t[--i-1]},redo:function(){if(i<t.length)return t[i++]}}}();function Remember(){var e=area.val();History.remember(e)}Remember();