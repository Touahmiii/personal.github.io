/*
 * Copyright (C) 2022 Text Tools. All Rights Reserved.
 * This file is part of texttools.org
 * Proprietary Software License
*/
var area=$("#input_output"),examples=JSON.parse(localStorage.getItem("ta_examples"));function AddLine(){var e=area.val().replace(/\n(?=.)/gm,"\n\n");area.val(e)}function Textoccurrence(){var e=area.val(),n=$("#text_occ").val().replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1"),t=$("#before_after").val();"before"==t?e=e.replace(new RegExp("("+n+")","g"),"\n$1"):"instead"==t?e=e.replace(new RegExp("("+n+")","g"),"\n"):"after"==t&&(e=e.replace(new RegExp("("+n+")","g"),"$1\n")),area.val(e)}function CharLen(){var e=area.val(),n=+$("#char_num").val();e=(e=(e=e.chunk(n)).join("\n")).replace(/\n /g,"\n"),area.val(e)}function loadText(){var e=$("#file_upload").get(0).files[0],n=new FileReader;n.onload=function(e){e=e.target.result;area.val(e)},n.readAsText(e,"UTF-8")}function saveText(e,n){var t=navigator.userAgent.match(/MSIE\s([\d.]+)/),a=navigator.userAgent.match(/Trident\/7.0/)&&navigator.userAgent.match(/rv:11/),r=navigator.userAgent.match(/Edge/g),a=t?t[1]:a?11:r?12:-1;t&&a<10?console.log("No blobs on IE ver<10"):(n=(n=document.getElementById("input_output").value).replace(/\r?\n/g,"\r\n"),r=new Blob([n],{type:"text/plain"}),"null.txt"!=(e=prompt("File name:","New Document")+".txt")&&(-1<a?window.navigator.msSaveBlob(r,e):((t=document.createElement("a")).download=e,t.href=window.URL.createObjectURL(r),t.onclick=function(e){document.body.removeChild(e.target)},t.style.display="none",document.body.appendChild(t),t.click())))}function printTextArea(){(childWindow=window.open("","childWindow","location=yes, menubar=yes, toolbar=yes")).document.open(),childWindow.document.write('<html><head></head><body style="word-wrap:break-word;"><style>.ap_container,.google-auto-placed,.adsbygoogle{display:none}</style>'),childWindow.document.write(document.getElementById("input_output").value.replace(/\n/gi,"<br>")),childWindow.document.write("</body></html>"),childWindow.print(),childWindow.document.close(),childWindow.close()}1==examples&&area.val("ABCABCABC"),$("#addLineBreaks").click(function(){Remember();area.val().replace(/\r\n|\r|\n/gm,"\n");var e=$("#settings").val();1==e?Textoccurrence():2==e?CharLen():3==e&&AddLine(),Toast("Applied"),Remember()}),String.prototype.chunk=function(e){return void 0===e&&(e=2),this.match(RegExp(".{1,"+e+"}","g"))},String.prototype.wordWrap=function(e,n,t){var a,r,o,c=this.split("\n");if(0<e)for(a in c){for(o=c[a],c[a]="";o.length>e;r=!t&&(r=o.substr(0,e).match(/\S*$/)).input.length-r[0].length||e,c[a]+=o.substr(0,r)+((o=o.substr(r)).length?n:""));c[a]+=o}return c.join("\n")},$("#settings").on("change",function(){var e=$("#settings").val();1==e?($(".character-number").hide(),$(".text-occurrence").show()):2==e?($(".text-occurrence").hide(),$(".character-number").show()):3==e&&$(".text-occurrence, .character-number").hide()}),$(".clipboard").click(function(){Clipboard(area)}),$("#clearAll, #edit_delete").click(function(){area.val(""),$("#instances").html("Lines removed: 0")}),$("#file_new").click(function(){area.val("")}),$("#file_upload").on("change",function(){loadText()}),$("#file_download").click(function(){saveText()}),$("#file_print").click(function(){printTextArea()}),$("#edit_undo").click(function(){var e=History.undo();void 0!==e&&area.val(e)}),$("#edit_redo").click(function(){var e=History.redo();void 0!==e&&area.val(e)}),$("#edit_copy").click(function(){Clipboard(area)}),$("#edit_select").click(function(){area.select().focus()});var History=function(){var n=[],t=0;return{remember:function(e){n[t-1]!==e&&(n.splice(t,10),n.push(e),n.splice(0,n.length-10),t=n.length)},undo:function(){if(1<t)return n[--t-1]},redo:function(){if(t<n.length)return n[t++]}}}();function Remember(){var e=area.val();History.remember(e)}Remember();
